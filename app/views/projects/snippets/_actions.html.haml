- return unless current_user

.hidden-xs
  - if can?(current_user, :update_project_snippet, @snippet)
    = link_to edit_namespace_project_snippet_path(@project.namespace, @project, @snippet), class: "btn btn-grouped" do
      编辑
  - if can?(current_user, :update_project_snippet, @snippet)
    = link_to namespace_project_snippet_path(@project.namespace, @project, @snippet), method: :delete, data: { confirm: "您确定继续吗？" }, class: "btn btn-grouped btn-inverted btn-remove", title: '删除代码段' do
      删除
  - if can?(current_user, :create_project_snippet, @project)
    = link_to new_namespace_project_snippet_path(@project.namespace, @project), class: 'btn btn-grouped btn-inverted btn-create', title: "新代码段" do
      新代码段
  - if @snippet.submittable_as_spam? && current_user.admin?
    = link_to '提交为垃圾邮件', mark_as_spam_namespace_project_snippet_path(@project.namespace, @project, @snippet), method: :post, class: 'btn btn-grouped btn-spam', title: '提交为垃圾邮件'
- if can?(current_user, :create_project_snippet, @project) || can?(current_user, :update_project_snippet, @snippet)
  .visible-xs-block.dropdown
    %button.btn.btn-default.btn-block.append-bottom-0.prepend-top-5{ data: { toggle: "dropdown" } }
      操作
      = icon('caret-down')
    .dropdown-menu.dropdown-menu-full-width
      %ul
        - if can?(current_user, :create_project_snippet, @project)
          %li
            = link_to new_namespace_project_snippet_path(@project.namespace, @project), title: "New snippet" do
              新代码段
        - if can?(current_user, :update_project_snippet, @snippet)
          %li
            = link_to namespace_project_snippet_path(@project.namespace, @project, @snippet), method: :delete, data: { confirm: "确定要删除么？" }, title: '删除代码段' do
              删除
        - if can?(current_user, :update_project_snippet, @snippet)
          %li
            = link_to edit_namespace_project_snippet_path(@project.namespace, @project, @snippet) do
              编辑
        - if @snippet.submittable_as_spam? && current_user.admin?
          %li
            = link_to '提交为垃圾邮件', mark_as_spam_namespace_project_snippet_path(@project.namespace, @project, @snippet), method: :post
